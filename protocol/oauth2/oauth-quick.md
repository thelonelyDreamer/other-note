# oauth2

## 一、简介

第三方认证技术方案最主要是解决认证协议的通用标准问题，因为要实现跨系统认证，各系统之间要遵循一定的 接口协议。AUTH协议为用户资源的授权提供了一个安全的、开放而又简易的标准。同时，任何第三方都可以使用OAUTH认 证服务，任何服务提供商都可以实现自身的OAUTH认证服务，因而OAUTH是开放的。

 业界提供了OAUTH的多种实现如PHP、JavaScript，Java，Ruby等各种语言开发包，大大节约了程序员的时间，因而OAUTH是简易的。互联网很多服务如Open API，很多大公司如Google，Yahoo，Microsoft等都提供了OAUTH认证服务，这些都足以说明OAUTH标准逐渐成为开放资源授权的标准。 Oauth协议目前发展到2.0版本，1.0版本过于复杂，2.0版本已得到广泛应用。

### 二、认证流程

### 2.1 认证流程

![](https://wx4.sinaimg.cn/mw2000/008tBfLHly1h33gp5cl42j30ff08v74i.jpg)

### 2.2 角色

1. 资源拥有者
   
   对资源拥有访问能力的实体，即用户。

2. 客户端
   
   在授权的情况下，代表资源拥有者，对受保护资源进行访问。

3. 授权服务
   
   对已备案的客户端，进行授权，颁发通信令牌。

4. 资源服务

        托管受保护的资源，可以接受并响应使用访问令牌对受保护资源的请求。

### 2.3 常用术语

- 客户凭证：客户端的clientId和密码用于认证客户

- 令牌：授权服务器在接收到客户请求后，颁发的访问令牌

- 作用域：客户请求访问令牌时，由资源拥有者额外指定的细分权限

- 授权码：仅用于授权码授权类型，用于交换获取访问令牌和刷新令牌

- 访问令牌：用于代表用户或者服务直接去访问受保护的资源

- 刷新令牌： 用于去授权服务器获取一个刷新访问令牌

- BearerToken: 不管谁拿到token都可以改访问令牌，类似现金

- proof of Possession(pop) token: 可以校验client是否对token有明确的拥有权

### 2.4 特点

**优点**

- 客户端不接触用户密码，客户端更容易集中保护

- 广泛传播并持续采用

- 短寿命和封装的token

- 资源服务器和授权服务器解耦

- 集中式授权，简化客户端

- http 和JSON友好

- 考虑各种客户端架构场景

- 客户可以具有不同的信任级别

**缺点**

- 协议框架太宽泛，造成各种实现的兼容性和互操作性差

- 本身不携带用户信息

    

## 三、授权模式

### 3.1 授权码模式

### 3.2 简化授权模式

### 3.3 密码模式

### 3.4 客户端模式

### 3.5 刷新令牌
